{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"../../firebase","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.fetchCodes = fetchCodes;\n  exports.LAST_FETCH = exports.FETCH_CODE_ERROR = exports.FETCH_CODE_SUCCESS = exports.FETCH_CODES_START = void 0;\n\n  var _regenerator = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/regenerator\"));\n\n  var _firebase = _$$_REQUIRE(_dependencyMap[2], \"../../firebase\");\n\n  var FETCH_CODES_START = 'FETCH_CODES_START';\n  exports.FETCH_CODES_START = FETCH_CODES_START;\n  var FETCH_CODE_SUCCESS = 'FETCH_CODE_SUCCESS';\n  exports.FETCH_CODE_SUCCESS = FETCH_CODE_SUCCESS;\n  var FETCH_CODE_ERROR = 'FETCH_CODE_ERROR';\n  exports.FETCH_CODE_ERROR = FETCH_CODE_ERROR;\n  var LAST_FETCH = 'LAST_FETCH';\n  exports.LAST_FETCH = LAST_FETCH;\n\n  function fetchCodes() {\n    return function _callee(dispatch) {\n      var result, companies, promiseArr, companyCodes;\n      return _regenerator.default.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              dispatch(startCodeFetching());\n              _context.prev = 1;\n              result = [];\n              _context.next = 5;\n              return _regenerator.default.awrap(_firebase.firestore.collection('companies').limit(5).get());\n\n            case 5:\n              companies = _context.sent;\n              promiseArr = [];\n              companies.forEach(function (company) {\n                var data = company.data();\n                result.push({\n                  storeName: data.name,\n                  logoImage: data.logoUrl,\n                  backgroundImage: data.backgroundUrl,\n                  codes: []\n                });\n                promiseArr.push(_firebase.firestore.collection('companies').doc(company.id).collection('codes').get());\n              });\n              _context.next = 10;\n              return _regenerator.default.awrap(Promise.all(promiseArr));\n\n            case 10:\n              companyCodes = _context.sent;\n              companyCodes.forEach(function (item, i) {\n                if (!item.empty) {\n                  item.docs.forEach(function (code) {\n                    code = code.data();\n                    var codeObj = {\n                      name: code.name,\n                      description: code.description,\n                      inStock: code.currentStock,\n                      discount: code.discount,\n                      price: code.price\n                    };\n                    result[i].codes.push(codeObj);\n                  });\n                }\n              });\n              dispatch(codeFetchingSuccess(result));\n              dispatch(codeLastFetch(Math.floor(Date.now() / 1000)));\n              _context.next = 19;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](1);\n              dispatch(codeFetchingError(_context.t0.message));\n\n            case 19:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[1, 16]]);\n    };\n  }\n\n  function startCodeFetching() {\n    return {\n      type: FETCH_CODES_START\n    };\n  }\n\n  function codeFetchingSuccess(codes) {\n    return {\n      type: FETCH_CODE_SUCCESS,\n      codes: codes\n    };\n  }\n\n  function codeFetchingError(error) {\n    return {\n      type: FETCH_CODE_ERROR,\n      error: error\n    };\n  }\n\n  function codeLastFetch(lastFetch) {\n    return {\n      type: LAST_FETCH,\n      lastFetch: lastFetch\n    };\n  }\n});","map":[[12,0,1,0],[14,0,3,7],[14,6,3,13,"FETCH_CODES_START"],[14,23,3,30],[14,26,3,33],[14,45,3,7],[16,0,4,7],[16,6,4,13,"FETCH_CODE_SUCCESS"],[16,24,4,31],[16,27,4,34],[16,47,4,7],[18,0,5,7],[18,6,5,13,"FETCH_CODE_ERROR"],[18,22,5,29],[18,25,5,32],[18,43,5,7],[20,0,6,7],[20,6,6,13,"LAST_FETCH"],[20,16,6,23],[20,19,6,26],[20,31,6,7],[23,0,8,7],[23,11,8,16,"fetchCodes"],[23,21,8,7],[23,24,8,29],[24,0,9,4],[24,11,9,11],[24,28,9,17,"dispatch"],[24,36,9,11],[25,0,9,11],[26,0,9,11],[27,0,9,11],[28,0,9,11],[29,0,9,11],[30,0,10,8,"dispatch"],[30,14,10,8,"dispatch"],[30,22,10,16],[30,23,10,17,"startCodeFetching"],[30,40,10,34],[30,42,10,16],[30,43,10,8],[31,0,9,11],[32,0,13,18,"result"],[32,14,13,18,"result"],[32,20,9,11],[32,23,13,27],[32,25,9,11],[33,0,9,11],[34,0,9,11],[34,48,14,36,"firestore"],[34,68,14,46,"collection"],[34,78,14,36],[34,79,14,57],[34,90,14,36],[34,92,14,70,"limit"],[34,97,14,36],[34,98,14,76],[34,99,14,36],[34,101,14,79,"get"],[34,104,14,36],[34,106,9,11],[36,0,9,11],[37,0,14,18,"companies"],[37,14,14,18,"companies"],[37,23,9,11],[38,0,15,18,"promiseArr"],[38,14,15,18,"promiseArr"],[38,24,9,11],[38,27,15,31],[38,29,9,11],[39,0,17,12,"companies"],[39,14,17,12,"companies"],[39,23,17,21],[39,24,17,22,"forEach"],[39,31,17,12],[39,32,17,30],[39,42,17,30,"company"],[39,49,17,37],[39,51,17,41],[40,0,18,16],[40,20,18,22,"data"],[40,24,18,26],[40,27,18,29,"company"],[40,34,18,36],[40,35,18,37,"data"],[40,39,18,29],[40,41,18,16],[41,0,20,16,"result"],[41,16,20,16,"result"],[41,22,20,22],[41,23,20,23,"push"],[41,27,20,16],[41,28,20,28],[42,0,21,20,"storeName"],[42,18,21,20,"storeName"],[42,27,21,29],[42,29,21,31,"data"],[42,33,21,35],[42,34,21,36,"name"],[42,38,20,28],[43,0,22,20,"logoImage"],[43,18,22,20,"logoImage"],[43,27,22,29],[43,29,22,31,"data"],[43,33,22,35],[43,34,22,36,"logoUrl"],[43,41,20,28],[44,0,23,20,"backgroundImage"],[44,18,23,20,"backgroundImage"],[44,33,23,35],[44,35,23,37,"data"],[44,39,23,41],[44,40,23,42,"backgroundUrl"],[44,53,20,28],[45,0,24,20,"codes"],[45,18,24,20,"codes"],[45,23,24,25],[45,25,24,27],[46,0,20,28],[46,17,20,16],[47,0,27,16,"promiseArr"],[47,16,27,16,"promiseArr"],[47,26,27,26],[47,27,27,27,"push"],[47,31,27,16],[47,32,28,20,"firestore"],[47,52,28,30,"collection"],[47,62,28,20],[47,63,28,41],[47,74,28,20],[47,76,28,54,"doc"],[47,79,28,20],[47,80,28,58,"company"],[47,87,28,65],[47,88,28,66,"id"],[47,90,28,20],[47,92,28,70,"collection"],[47,102,28,20],[47,103,28,81],[47,110,28,20],[47,112,28,90,"get"],[47,115,28,20],[47,117,27,16],[48,0,30,13],[48,15,17,12],[49,0,9,11],[50,0,9,11],[50,48,32,39,"Promise"],[50,55,32,46],[50,56,32,47,"all"],[50,59,32,39],[50,60,32,51,"promiseArr"],[50,70,32,39],[50,71,9,11],[52,0,9,11],[53,0,32,18,"companyCodes"],[53,14,32,18,"companyCodes"],[53,26,9,11],[54,0,34,12,"companyCodes"],[54,14,34,12,"companyCodes"],[54,26,34,24],[54,27,34,25,"forEach"],[54,34,34,12],[54,35,34,33],[54,45,34,34,"item"],[54,49,34,33],[54,51,34,40,"i"],[54,52,34,33],[54,54,34,46],[55,0,36,16],[55,20,36,19],[55,21,36,20,"item"],[55,25,36,24],[55,26,36,25,"empty"],[55,31,36,16],[55,33,36,32],[56,0,37,20,"item"],[56,18,37,20,"item"],[56,22,37,24],[56,23,37,25,"docs"],[56,27,37,20],[56,28,37,30,"forEach"],[56,35,37,20],[56,36,37,38],[56,46,37,38,"code"],[56,50,37,42],[56,52,37,46],[57,0,38,24,"code"],[57,20,38,24,"code"],[57,24,38,28],[57,27,38,31,"code"],[57,31,38,35],[57,32,38,36,"data"],[57,36,38,31],[57,38,38,24],[58,0,39,23],[58,24,39,29,"codeObj"],[58,31,39,36],[58,34,39,39],[59,0,40,27,"name"],[59,22,40,27,"name"],[59,26,40,31],[59,28,40,33,"code"],[59,32,40,37],[59,33,40,38,"name"],[59,37,39,39],[60,0,41,27,"description"],[60,22,41,27,"description"],[60,33,41,38],[60,35,41,40,"code"],[60,39,41,44],[60,40,41,45,"description"],[60,51,39,39],[61,0,42,27,"inStock"],[61,22,42,27,"inStock"],[61,29,42,34],[61,31,42,36,"code"],[61,35,42,40],[61,36,42,41,"currentStock"],[61,48,39,39],[62,0,43,27,"discount"],[62,22,43,27,"discount"],[62,30,43,35],[62,32,43,37,"code"],[62,36,43,41],[62,37,43,42,"discount"],[62,45,39,39],[63,0,44,27,"price"],[63,22,44,27,"price"],[63,27,44,32],[63,29,44,34,"code"],[63,33,44,38],[63,34,44,39,"price"],[64,0,39,39],[64,21,39,23],[65,0,47,23,"result"],[65,20,47,23,"result"],[65,26,47,29],[65,27,47,30,"i"],[65,28,47,29],[65,29,47,23],[65,30,47,33,"codes"],[65,35,47,23],[65,36,47,39,"push"],[65,40,47,23],[65,41,47,44,"codeObj"],[65,48,47,23],[66,0,48,21],[66,19,37,20],[67,0,49,17],[68,0,51,13],[68,15,34,12],[69,0,53,12,"dispatch"],[69,14,53,12,"dispatch"],[69,22,53,20],[69,23,53,21,"codeFetchingSuccess"],[69,42,53,40],[69,43,53,41,"result"],[69,49,53,40],[69,50,53,20],[69,51,53,12],[70,0,54,12,"dispatch"],[70,14,54,12,"dispatch"],[70,22,54,20],[70,23,54,21,"codeLastFetch"],[70,36,54,34],[70,37,54,35,"Math"],[70,41,54,39],[70,42,54,40,"floor"],[70,47,54,35],[70,48,54,46,"Date"],[70,52,54,50],[70,53,54,51,"now"],[70,56,54,46],[70,61,54,59],[70,65,54,35],[70,66,54,34],[70,67,54,20],[70,68,54,12],[71,0,9,11],[72,0,9,11],[74,0,9,11],[75,0,9,11],[76,0,9,11],[77,0,57,12,"dispatch"],[77,14,57,12,"dispatch"],[77,22,57,20],[77,23,57,21,"codeFetchingError"],[77,40,57,38],[77,41,57,39],[77,53,57,45,"message"],[77,60,57,38],[77,61,57,20],[77,62,57,12],[79,0,9,11],[80,0,9,11],[81,0,9,11],[82,0,9,11],[83,0,9,11],[84,0,9,11],[85,0,9,11],[85,5,9,4],[86,0,61,1],[88,0,63,0],[88,11,63,9,"startCodeFetching"],[88,28,63,0],[88,31,63,29],[89,0,64,4],[89,11,64,11],[90,0,65,8,"type"],[90,6,65,8,"type"],[90,10,65,12],[90,12,65,14,"FETCH_CODES_START"],[91,0,64,11],[91,5,64,4],[92,0,67,1],[94,0,69,0],[94,11,69,9,"codeFetchingSuccess"],[94,30,69,0],[94,31,69,29,"codes"],[94,36,69,0],[94,38,69,36],[95,0,70,4],[95,11,70,11],[96,0,71,8,"type"],[96,6,71,8,"type"],[96,10,71,12],[96,12,71,14,"FETCH_CODE_SUCCESS"],[96,30,70,11],[97,0,72,8,"codes"],[97,6,72,8,"codes"],[97,11,72,13],[97,13,72,8,"codes"],[98,0,70,11],[98,5,70,4],[99,0,74,1],[101,0,76,0],[101,11,76,9,"codeFetchingError"],[101,28,76,0],[101,29,76,27,"error"],[101,34,76,0],[101,36,76,34],[102,0,77,4],[102,11,77,11],[103,0,78,8,"type"],[103,6,78,8,"type"],[103,10,78,12],[103,12,78,14,"FETCH_CODE_ERROR"],[103,28,77,11],[104,0,79,8,"error"],[104,6,79,8,"error"],[104,11,79,13],[104,13,79,8,"error"],[105,0,77,11],[105,5,77,4],[106,0,81,1],[108,0,83,0],[108,11,83,9,"codeLastFetch"],[108,24,83,0],[108,25,83,23,"lastFetch"],[108,34,83,0],[108,36,83,34],[109,0,84,4],[109,11,84,11],[110,0,85,8,"type"],[110,6,85,8,"type"],[110,10,85,12],[110,12,85,14,"LAST_FETCH"],[110,22,84,11],[111,0,86,8,"lastFetch"],[111,6,86,8,"lastFetch"],[111,15,86,17],[111,17,86,8,"lastFetch"],[112,0,84,11],[112,5,84,4],[113,0,88,1]]},"type":"js/module"}]}