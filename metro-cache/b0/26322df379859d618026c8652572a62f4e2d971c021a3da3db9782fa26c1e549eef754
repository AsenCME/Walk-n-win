{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"../../firebase","data":{"isAsync":false}},{"name":"../../navigation/index","data":{"isAsync":false}},{"name":"../includes/User","data":{"isAsync":false}},{"name":"./activityActions","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.createUserWithEmail = createUserWithEmail;\n  exports.userLogout = userLogout;\n  exports.loginUser = loginUser;\n  exports.saveUser = saveUser;\n  exports.logoutUser = logoutUser;\n  exports.setLastSync = setLastSync;\n  exports.setLastEnter = setLastEnter;\n  exports.SET_LAST_ENTER = exports.SET_LAST_SYNC = exports.LOGOUT = exports.SAVE_USER = void 0;\n\n  var _regenerator = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/regenerator\"));\n\n  var _firebase = _$$_REQUIRE(_dependencyMap[2], \"../../firebase\");\n\n  var _index = _$$_REQUIRE(_dependencyMap[3], \"../../navigation/index\");\n\n  var _User = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"../includes/User\"));\n\n  var _activityActions = _$$_REQUIRE(_dependencyMap[5], \"./activityActions\");\n\n  var SAVE_USER = 'SAVE_USER';\n  exports.SAVE_USER = SAVE_USER;\n  var LOGOUT = 'LOGOUT';\n  exports.LOGOUT = LOGOUT;\n  var SET_LAST_SYNC = 'SET_LAST_SYNC';\n  exports.SET_LAST_SYNC = SET_LAST_SYNC;\n  var SET_LAST_ENTER = 'SET_LAST_ENTER';\n  exports.SET_LAST_ENTER = SET_LAST_ENTER;\n\n  function createUserWithEmail(email, password, username) {\n    return function (dispatch) {\n      (0, _index.showLoading)();\n      return _firebase.auth.createUserWithEmailAndPassword(email, password).then(function _callee(user) {\n        var uid, newUser;\n        return _regenerator.default.async(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                uid = user.user.uid;\n                _context.prev = 1;\n                newUser = _User.default.createUser(username);\n                _context.next = 5;\n                return _regenerator.default.awrap(_firebase.firestore.collection('users').doc(uid).set(newUser));\n\n              case 5:\n                (0, _index.hideLoading)();\n                return _context.abrupt(\"return\", dispatch(saveUser(newUser)));\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](1);\n                _context.next = 13;\n                return _regenerator.default.awrap(_User.default.deleteCurrentUser());\n\n              case 13:\n                (0, _index.hideLoading)();\n                return _context.abrupt(\"return\", new Error(_context.t0.message));\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, [[1, 9]]);\n      }).catch(function (err) {\n        var message = '';\n\n        if (err.code === 'auth/email-already-in-use') {\n          message = 'Имейл адресът е зает';\n        } else if (err.code === 'auth/invalid-email') {\n          message = 'Невалиден имейл адрес';\n        } else {\n          message = 'Грешка';\n        }\n\n        console.log('An error occured during account creation. Possible firestore db error', err);\n        (0, _index.hideLoading)();\n        return new Error(message);\n      });\n    };\n  }\n\n  function userLogout() {\n    return function (dispatch) {\n      dispatch(logoutUser());\n      dispatch((0, _activityActions.resetData)());\n      return _firebase.auth.signOut();\n    };\n  }\n\n  function loginUser(email, password) {\n    return function (dispatch) {\n      (0, _index.showLoading)();\n      return _firebase.auth.signInWithEmailAndPassword(email, password).then(function _callee2(user) {\n        var uid, data;\n        return _regenerator.default.async(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                uid = user.user.uid;\n                _context2.prev = 1;\n                _context2.next = 4;\n                return _regenerator.default.awrap(_firebase.firestore.collection('users').doc(uid).get());\n\n              case 4:\n                data = _context2.sent;\n                console.log(\"User Logged In\", data.data());\n                dispatch(saveUser(data.data()));\n                (0, _index.hideLoading)();\n                return _context2.abrupt(\"return\", data.data());\n\n              case 11:\n                _context2.prev = 11;\n                _context2.t0 = _context2[\"catch\"](1);\n                console.log(\"Error on login after fetching firebase data\", _context2.t0);\n                (0, _index.hideLoading)();\n                return _context2.abrupt(\"return\", new Error(_context2.t0.message));\n\n              case 16:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, null, null, [[1, 11]]);\n      }).catch(function (err) {\n        var message = '';\n\n        if (err.code === 'auth/wrong-password') {\n          message = 'Паролата не съвпада';\n        } else if (err.code === _firebase.auth / user - not - found) {\n          message = 'Несъществуващ потребител';\n        } else message = 'Възникна грешка';\n\n        (0, _index.hideLoading)();\n        return new Error(message);\n      });\n    };\n  }\n\n  function saveUser(data) {\n    return {\n      type: SAVE_USER,\n      paylord: data\n    };\n  }\n\n  function logoutUser() {\n    return {\n      type: LOGOUT\n    };\n  }\n\n  function setLastSync(date) {\n    return {\n      type: SET_LAST_SYNC,\n      date: date\n    };\n  }\n\n  function setLastEnter(date) {\n    return {\n      type: SET_LAST_ENTER,\n      date: date\n    };\n  }\n});","map":[[18,0,1,0],[20,0,2,0],[22,0,3,0],[24,0,4,0],[26,0,6,7],[26,6,6,13,"SAVE_USER"],[26,15,6,22],[26,18,6,25],[26,29,6,7],[28,0,7,7],[28,6,7,13,"LOGOUT"],[28,12,7,19],[28,15,7,25],[28,23,7,7],[30,0,8,7],[30,6,8,13,"SET_LAST_SYNC"],[30,19,8,26],[30,22,8,30],[30,37,8,7],[32,0,9,7],[32,6,9,13,"SET_LAST_ENTER"],[32,20,9,27],[32,23,9,30],[32,39,9,7],[35,0,20,7],[35,11,20,16,"createUserWithEmail"],[35,30,20,7],[35,31,20,36,"email"],[35,36,20,7],[35,38,20,43,"password"],[35,46,20,7],[35,48,20,53,"username"],[35,56,20,7],[35,58,20,63],[36,0,21,4],[36,11,21,11],[36,21,21,11,"dispatch"],[36,29,21,19],[36,31,21,23],[37,0,23,8],[38,0,24,8],[38,13,24,15,"auth"],[38,28,24,20,"createUserWithEmailAndPassword"],[38,58,24,15],[38,59,24,51,"email"],[38,64,24,15],[38,66,24,57,"password"],[38,74,24,15],[38,76,25,9,"then"],[38,80,24,15],[38,81,25,14],[38,98,25,20,"user"],[38,102,25,14],[39,0,25,14],[40,0,25,14],[41,0,25,14],[42,0,25,14],[43,0,25,14],[44,0,26,18,"uid"],[44,16,26,18,"uid"],[44,19,25,14],[44,22,26,24,"user"],[44,26,26,28],[44,27,26,29,"user"],[44,31,26,24],[44,32,26,34,"uid"],[44,35,25,14],[45,0,25,14],[46,0,28,22,"newUser"],[46,16,28,22,"newUser"],[46,23,25,14],[46,26,28,32,"User"],[46,40,28,37,"createUser"],[46,50,28,32],[46,51,28,48,"username"],[46,59,28,32],[46,60,25,14],[47,0,25,14],[48,0,25,14],[48,50,30,22,"firestore"],[48,70,30,32,"collection"],[48,80,30,22],[48,81,30,43],[48,88,30,22],[48,90,30,52,"doc"],[48,93,30,22],[48,94,30,56,"uid"],[48,97,30,22],[48,99,30,61,"set"],[48,102,30,22],[48,103,30,65,"newUser"],[48,110,30,22],[48,111,25,14],[50,0,25,14],[51,0,33,16],[52,0,25,14],[52,49,35,23,"dispatch"],[52,57,35,31],[52,58,35,32,"saveUser"],[52,66,35,40],[52,67,35,41,"newUser"],[52,74,35,40],[52,75,35,31],[52,76,25,14],[54,0,25,14],[55,0,25,14],[56,0,25,14],[57,0,25,14],[58,0,25,14],[58,50,39,22,"User"],[58,64,39,27,"deleteCurrentUser"],[58,81,39,22],[58,83,25,14],[60,0,25,14],[61,0,42,16],[62,0,25,14],[62,49,43,23],[62,53,43,27,"Error"],[62,58,43,23],[62,59,43,33],[62,71,43,37,"message"],[62,78,43,23],[62,79,25,14],[64,0,25,14],[65,0,25,14],[66,0,25,14],[67,0,25,14],[68,0,25,14],[69,0,25,14],[70,0,25,14],[70,7,24,15],[70,9,47,9,"catch"],[70,14,24,15],[70,15,47,15],[70,25,47,15,"err"],[70,28,47,18],[70,30,47,22],[71,0,48,12],[71,12,48,16,"message"],[71,19,48,23],[71,22,48,26],[71,24,48,12],[73,0,49,12],[73,12,49,15,"err"],[73,15,49,18],[73,16,49,19,"code"],[73,20,49,15],[73,25,49,28],[73,52,49,12],[73,54,49,57],[74,0,50,16,"message"],[74,10,50,16,"message"],[74,17,50,23],[74,20,50,26],[74,42,50,16],[75,0,51,13],[75,9,49,12],[75,15,52,17],[75,19,52,20,"err"],[75,22,52,23],[75,23,52,24,"code"],[75,27,52,20],[75,32,52,33],[75,52,52,17],[75,54,52,55],[76,0,53,16,"message"],[76,10,53,16,"message"],[76,17,53,23],[76,20,53,26],[76,43,53,16],[77,0,54,13],[77,9,52,17],[77,15,55,17],[78,0,56,16,"message"],[78,10,56,16,"message"],[78,17,56,23],[78,20,56,26],[78,28,56,16],[79,0,57,13],[81,0,58,12,"console"],[81,8,58,12,"console"],[81,15,58,19],[81,16,58,20,"log"],[81,19,58,12],[81,20,58,24],[81,91,58,12],[81,93,58,97,"err"],[81,96,58,12],[82,0,61,12],[83,0,62,12],[83,15,62,19],[83,19,62,23,"Error"],[83,24,62,19],[83,25,62,29,"message"],[83,32,62,19],[83,33,62,12],[84,0,63,9],[84,7,24,15],[84,8,24,8],[85,0,64,5],[85,5,21,4],[86,0,65,1],[88,0,71,7],[88,11,71,16,"userLogout"],[88,21,71,7],[88,24,71,29],[89,0,72,4],[89,11,72,11],[89,21,72,11,"dispatch"],[89,29,72,19],[89,31,72,23],[90,0,73,8,"dispatch"],[90,6,73,8,"dispatch"],[90,14,73,16],[90,15,73,17,"logoutUser"],[90,25,73,27],[90,27,73,16],[90,28,73,8],[91,0,74,8,"dispatch"],[91,6,74,8,"dispatch"],[91,14,74,16],[91,15,74,17],[91,48,74,16],[91,49,74,8],[92,0,76,8],[92,13,76,15,"auth"],[92,28,76,20,"signOut"],[92,35,76,15],[92,37,76,8],[93,0,77,5],[93,5,72,4],[94,0,78,1],[96,0,87,7],[96,11,87,16,"loginUser"],[96,20,87,7],[96,21,87,26,"email"],[96,26,87,7],[96,28,87,33,"password"],[96,36,87,7],[96,38,87,43],[97,0,88,4],[97,11,88,11],[97,21,88,11,"dispatch"],[97,29,88,19],[97,31,88,23],[98,0,89,8],[99,0,90,8],[99,13,90,15,"auth"],[99,28,90,20,"signInWithEmailAndPassword"],[99,54,90,15],[99,55,90,47,"email"],[99,60,90,15],[99,62,90,54,"password"],[99,70,90,15],[99,72,91,9,"then"],[99,76,90,15],[99,77,91,14],[99,95,91,20,"user"],[99,99,91,14],[100,0,91,14],[101,0,91,14],[102,0,91,14],[103,0,91,14],[104,0,91,14],[105,0,92,18,"uid"],[105,16,92,18,"uid"],[105,19,91,14],[105,22,92,24,"user"],[105,26,92,28],[105,27,92,29,"user"],[105,31,92,24],[105,32,92,34,"uid"],[105,35,91,14],[106,0,91,14],[107,0,91,14],[108,0,91,14],[108,50,95,35,"firestore"],[108,70,95,45,"collection"],[108,80,95,35],[108,81,95,56],[108,88,95,35],[108,90,95,65,"doc"],[108,93,95,35],[108,94,95,69,"uid"],[108,97,95,35],[108,99,95,74,"get"],[108,102,95,35],[108,104,91,14],[110,0,91,14],[111,0,95,22,"data"],[111,16,95,22,"data"],[111,20,91,14],[112,0,97,16,"console"],[112,16,97,16,"console"],[112,23,97,23],[112,24,97,24,"log"],[112,27,97,16],[112,28,97,28],[112,44,97,16],[112,46,97,46,"data"],[112,50,97,50],[112,51,97,51,"data"],[112,55,97,46],[112,57,97,16],[113,0,99,16,"dispatch"],[113,16,99,16,"dispatch"],[113,24,99,24],[113,25,99,25,"saveUser"],[113,33,99,33],[113,34,99,34,"data"],[113,38,99,38],[113,39,99,39,"data"],[113,43,99,34],[113,45,99,33],[113,46,99,24],[113,47,99,16],[114,0,101,16],[115,0,91,14],[115,50,103,23,"data"],[115,54,103,27],[115,55,103,28,"data"],[115,59,103,23],[115,61,91,14],[117,0,91,14],[118,0,91,14],[119,0,91,14],[120,0,106,16,"console"],[120,16,106,16,"console"],[120,23,106,23],[120,24,106,24,"log"],[120,27,106,16],[120,28,106,28],[120,73,106,16],[121,0,107,16],[122,0,91,14],[122,50,108,23],[122,54,108,27,"Error"],[122,59,108,23],[122,60,108,33],[122,73,108,37,"message"],[122,80,108,23],[122,81,91,14],[124,0,91,14],[125,0,91,14],[126,0,91,14],[127,0,91,14],[128,0,91,14],[129,0,91,14],[130,0,91,14],[130,7,90,15],[130,9,111,9,"catch"],[130,14,90,15],[130,15,111,15],[130,25,111,15,"err"],[130,28,111,18],[130,30,111,22],[131,0,112,12],[131,12,112,16,"message"],[131,19,112,23],[131,22,112,26],[131,24,112,12],[133,0,113,12],[133,12,113,15,"err"],[133,15,113,18],[133,16,113,19,"code"],[133,20,113,15],[133,25,113,28],[133,46,113,12],[133,48,113,51],[134,0,114,16,"message"],[134,10,114,16,"message"],[134,17,114,23],[134,20,114,26],[134,41,114,16],[135,0,115,13],[135,9,113,12],[135,15,115,19],[135,19,115,22,"err"],[135,22,115,25],[135,23,115,26,"code"],[135,27,115,22],[135,32,115,35,"auth"],[135,49,115,40,"user"],[135,53,115,35],[135,56,115,45,"not"],[135,59,115,35],[135,62,115,49,"found"],[135,67,115,19],[135,69,115,56],[136,0,116,16,"message"],[136,10,116,16,"message"],[136,17,116,23],[136,20,116,26],[136,46,116,16],[137,0,117,13],[137,9,115,19],[137,15,118,17,"message"],[137,22,118,24],[137,25,118,27],[137,42,118,17],[139,0,119,12],[140,0,120,12],[140,15,120,19],[140,19,120,23,"Error"],[140,24,120,19],[140,25,120,29,"message"],[140,32,120,19],[140,33,120,12],[141,0,121,9],[141,7,90,15],[141,8,90,8],[142,0,122,5],[142,5,88,4],[143,0,123,1],[145,0,125,7],[145,11,125,16,"saveUser"],[145,19,125,7],[145,20,125,25,"data"],[145,24,125,7],[145,26,125,31],[146,0,126,4],[146,11,126,11],[147,0,127,8,"type"],[147,6,127,8,"type"],[147,10,127,12],[147,12,127,14,"SAVE_USER"],[147,21,126,11],[148,0,128,8,"paylord"],[148,6,128,8,"paylord"],[148,13,128,15],[148,15,128,17,"data"],[149,0,126,11],[149,5,126,4],[150,0,130,1],[152,0,132,7],[152,11,132,16,"logoutUser"],[152,21,132,7],[152,24,132,29],[153,0,133,4],[153,11,133,11],[154,0,134,8,"type"],[154,6,134,8,"type"],[154,10,134,12],[154,12,134,14,"LOGOUT"],[155,0,133,11],[155,5,133,4],[156,0,136,1],[158,0,138,7],[158,11,138,16,"setLastSync"],[158,22,138,7],[158,23,138,28,"date"],[158,27,138,7],[158,29,138,34],[159,0,139,4],[159,11,139,11],[160,0,140,8,"type"],[160,6,140,8,"type"],[160,10,140,12],[160,12,140,14,"SET_LAST_SYNC"],[160,25,139,11],[161,0,141,8,"date"],[161,6,141,8,"date"],[161,10,141,12],[161,12,141,8,"date"],[162,0,139,11],[162,5,139,4],[163,0,143,1],[165,0,145,7],[165,11,145,16,"setLastEnter"],[165,23,145,7],[165,24,145,29,"date"],[165,28,145,7],[165,30,145,35],[166,0,146,4],[166,11,146,11],[167,0,147,8,"type"],[167,6,147,8,"type"],[167,10,147,12],[167,12,147,14,"SET_LAST_ENTER"],[167,26,146,11],[168,0,148,8,"date"],[168,6,148,8,"date"],[168,10,148,12],[168,12,148,8,"date"],[169,0,146,11],[169,5,146,4],[170,0,150,1]]},"type":"js/module"}]}