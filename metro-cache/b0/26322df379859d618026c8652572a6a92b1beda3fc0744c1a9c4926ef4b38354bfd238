{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"../../firebase","data":{"isAsync":false}},{"name":"../includes/User","data":{"isAsync":false}},{"name":"./activityActions","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.createUserWithEmail = createUserWithEmail;\n  exports.userLogout = userLogout;\n  exports.loginUser = loginUser;\n  exports.saveUser = saveUser;\n  exports.logoutUser = logoutUser;\n  exports.setLastSync = setLastSync;\n  exports.setLastEnter = setLastEnter;\n  exports.SET_LAST_ENTER = exports.SET_LAST_SYNC = exports.LOGOUT = exports.SAVE_USER = void 0;\n\n  var _regenerator = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/regenerator\"));\n\n  var _firebase = _$$_REQUIRE(_dependencyMap[2], \"../../firebase\");\n\n  var _User = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[3], \"../includes/User\"));\n\n  var _activityActions = _$$_REQUIRE(_dependencyMap[4], \"./activityActions\");\n\n  var SAVE_USER = 'SAVE_USER';\n  exports.SAVE_USER = SAVE_USER;\n  var LOGOUT = 'LOGOUT';\n  exports.LOGOUT = LOGOUT;\n  var SET_LAST_SYNC = 'SET_LAST_SYNC';\n  exports.SET_LAST_SYNC = SET_LAST_SYNC;\n  var SET_LAST_ENTER = 'SET_LAST_ENTER';\n  exports.SET_LAST_ENTER = SET_LAST_ENTER;\n\n  function createUserWithEmail(email, password, username) {\n    return function (dispatch) {\n      return _firebase.auth.createUserWithEmailAndPassword(email, password).then(function _callee(user) {\n        var uid, newUser, message;\n        return _regenerator.default.async(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                uid = user.user.uid;\n                console.log(uid);\n                _context.prev = 2;\n                newUser = _User.default.createUser(username);\n                console.log(newUser);\n                _context.next = 7;\n                return _regenerator.default.awrap(_firebase.firestore.collection('users').doc(uid).set(newUser));\n\n              case 7:\n                return _context.abrupt(\"return\", dispatch(saveUser(newUser)));\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](2);\n                _context.next = 14;\n                return _regenerator.default.awrap(_User.default.deleteCurrentUser());\n\n              case 14:\n                message = 'Възникна грешка';\n                console.log('Greshka');\n                return _context.abrupt(\"return\", new Error(message));\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, null, null, [[2, 10]]);\n      }).catch(function (err) {\n        var message = '';\n\n        if (err.code === 'auth/email-already-in-use') {\n          message = 'Имейл адресът е зает';\n        } else if (err.code === 'auth/invalid-email') {\n          message = 'Невалиден имейл адрес';\n        } else {\n          message = 'Грешка';\n        }\n\n        console.log('Big Error');\n        return new Error(message);\n      });\n    };\n  }\n\n  function userLogout() {\n    return function (dispatch) {\n      dispatch(logoutUser());\n      dispatch((0, _activityActions.resetData)());\n      return _firebase.auth.signOut();\n    };\n  }\n\n  function loginUser(email, password) {\n    return function (dispatch) {\n      return _firebase.auth.signInWithEmailAndPassword(email, password).then(function _callee2(user) {\n        var uid, test, data, parsed;\n        return _regenerator.default.async(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                uid = user.user.uid;\n                console.log(uid);\n                _context2.next = 4;\n                return _regenerator.default.awrap(_firebase.firestore.collection('users').get());\n\n              case 4:\n                test = _context2.sent;\n                console.log(test.docs[0].data());\n                _context2.prev = 6;\n                console.log(uid, 'before data fetch');\n                _context2.next = 10;\n                return _regenerator.default.awrap(_firebase.firestore.collection('users').doc(uid).get());\n\n              case 10:\n                data = _context2.sent;\n                console.log('after fetch');\n                parsed = data.data();\n                console.log(\"Parsed logging data\", parsed);\n                dispatch(saveUser(parsed));\n                return _context2.abrupt(\"return\", parsed);\n\n              case 18:\n                _context2.prev = 18;\n                _context2.t0 = _context2[\"catch\"](6);\n                console.log(_context2.t0);\n                return _context2.abrupt(\"return\", new Error('Възникна грешка'));\n\n              case 22:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, null, null, [[6, 18]]);\n      }).catch(function (err) {\n        var message = '';\n\n        if (err.code === 'auth/wrong-password') {\n          message = 'Паролата не съвпада';\n        } else if (err.code === _firebase.auth / user - not - found) {\n          message = 'Несъществуващ потребител';\n        } else message = 'Възникна грешка';\n\n        return new Error(message);\n      });\n    };\n  }\n\n  function saveUser(data) {\n    return {\n      type: SAVE_USER,\n      paylord: data\n    };\n  }\n\n  function logoutUser() {\n    return {\n      type: LOGOUT\n    };\n  }\n\n  function setLastSync(date) {\n    return {\n      type: SET_LAST_SYNC,\n      date: date\n    };\n  }\n\n  function setLastEnter(date) {\n    return {\n      type: SET_LAST_ENTER,\n      date: date\n    };\n  }\n});","map":[[18,0,1,0],[20,0,2,0],[22,0,3,0],[24,0,5,7],[24,6,5,13,"SAVE_USER"],[24,15,5,22],[24,18,5,25],[24,29,5,7],[26,0,6,7],[26,6,6,13,"LOGOUT"],[26,12,6,19],[26,15,6,25],[26,23,6,7],[28,0,7,7],[28,6,7,13,"SET_LAST_SYNC"],[28,19,7,26],[28,22,7,29],[28,37,7,7],[30,0,8,7],[30,6,8,13,"SET_LAST_ENTER"],[30,20,8,27],[30,23,8,30],[30,39,8,7],[33,0,10,7],[33,11,10,16,"createUserWithEmail"],[33,30,10,7],[33,31,10,36,"email"],[33,36,10,7],[33,38,10,43,"password"],[33,46,10,7],[33,48,10,53,"username"],[33,56,10,7],[33,58,10,63],[34,0,11,4],[34,11,11,11],[34,21,11,11,"dispatch"],[34,29,11,19],[34,31,11,23],[35,0,12,8],[35,13,12,15,"auth"],[35,28,12,20,"createUserWithEmailAndPassword"],[35,58,12,15],[35,59,12,51,"email"],[35,64,12,15],[35,66,12,57,"password"],[35,74,12,15],[35,76,13,9,"then"],[35,80,12,15],[35,81,13,14],[35,98,13,20,"user"],[35,102,13,14],[36,0,13,14],[37,0,13,14],[38,0,13,14],[39,0,13,14],[40,0,13,14],[41,0,14,18,"uid"],[41,16,14,18,"uid"],[41,19,13,14],[41,22,14,24,"user"],[41,26,14,28],[41,27,14,29,"user"],[41,31,14,24],[41,32,14,34,"uid"],[41,35,13,14],[42,0,15,12,"console"],[42,16,15,12,"console"],[42,23,15,19],[42,24,15,20,"log"],[42,27,15,12],[42,28,15,24,"uid"],[42,31,15,12],[43,0,13,14],[44,0,17,22,"newUser"],[44,16,17,22,"newUser"],[44,23,13,14],[44,26,17,32,"User"],[44,40,17,37,"createUser"],[44,50,17,32],[44,51,17,48,"username"],[44,59,17,32],[44,60,13,14],[45,0,18,16,"console"],[45,16,18,16,"console"],[45,23,18,23],[45,24,18,24,"log"],[45,27,18,16],[45,28,18,28,"newUser"],[45,35,18,16],[46,0,13,14],[47,0,13,14],[47,50,20,22,"firestore"],[47,70,20,32,"collection"],[47,80,20,22],[47,81,20,43],[47,88,20,22],[47,90,20,52,"doc"],[47,93,20,22],[47,94,20,56,"uid"],[47,97,20,22],[47,99,20,61,"set"],[47,102,20,22],[47,103,20,65,"newUser"],[47,110,20,22],[47,111,13,14],[49,0,13,14],[50,0,13,14],[50,49,22,23,"dispatch"],[50,57,22,31],[50,58,22,32,"saveUser"],[50,66,22,40],[50,67,22,41,"newUser"],[50,74,22,40],[50,75,22,31],[50,76,13,14],[52,0,13,14],[53,0,13,14],[54,0,13,14],[55,0,13,14],[56,0,13,14],[56,50,25,22,"User"],[56,64,25,27,"deleteCurrentUser"],[56,81,25,22],[56,83,13,14],[58,0,13,14],[59,0,26,22,"message"],[59,16,26,22,"message"],[59,23,13,14],[59,26,26,32],[59,43,13,14],[60,0,27,16,"console"],[60,16,27,16,"console"],[60,23,27,23],[60,24,27,24,"log"],[60,27,27,16],[60,28,27,28],[60,37,27,16],[61,0,13,14],[61,49,28,23],[61,53,28,27,"Error"],[61,58,28,23],[61,59,28,33,"message"],[61,66,28,23],[61,67,13,14],[63,0,13,14],[64,0,13,14],[65,0,13,14],[66,0,13,14],[67,0,13,14],[68,0,13,14],[69,0,13,14],[69,7,12,15],[69,9,32,9,"catch"],[69,14,12,15],[69,15,32,15],[69,25,32,15,"err"],[69,28,32,18],[69,30,32,22],[70,0,33,12],[70,12,33,16,"message"],[70,19,33,23],[70,22,33,26],[70,24,33,12],[72,0,34,12],[72,12,34,15,"err"],[72,15,34,18],[72,16,34,19,"code"],[72,20,34,15],[72,25,34,28],[72,52,34,12],[72,54,34,57],[73,0,35,16,"message"],[73,10,35,16,"message"],[73,17,35,23],[73,20,35,26],[73,42,35,16],[74,0,36,13],[74,9,34,12],[74,15,37,17],[74,19,37,20,"err"],[74,22,37,23],[74,23,37,24,"code"],[74,27,37,20],[74,32,37,33],[74,52,37,17],[74,54,37,55],[75,0,38,16,"message"],[75,10,38,16,"message"],[75,17,38,23],[75,20,38,26],[75,43,38,16],[76,0,39,13],[76,9,37,17],[76,15,40,17],[77,0,41,16,"message"],[77,10,41,16,"message"],[77,17,41,23],[77,20,41,26],[77,28,41,16],[78,0,42,13],[80,0,43,12,"console"],[80,8,43,12,"console"],[80,15,43,19],[80,16,43,20,"log"],[80,19,43,12],[80,20,43,24],[80,31,43,12],[81,0,44,12],[81,15,44,19],[81,19,44,23,"Error"],[81,24,44,19],[81,25,44,29,"message"],[81,32,44,19],[81,33,44,12],[82,0,45,9],[82,7,12,15],[82,8,12,8],[83,0,46,5],[83,5,11,4],[84,0,47,1],[86,0,49,7],[86,11,49,16,"userLogout"],[86,21,49,7],[86,24,49,29],[87,0,50,4],[87,11,50,11],[87,21,50,11,"dispatch"],[87,29,50,19],[87,31,50,23],[88,0,51,8,"dispatch"],[88,6,51,8,"dispatch"],[88,14,51,16],[88,15,51,17,"logoutUser"],[88,25,51,27],[88,27,51,16],[88,28,51,8],[89,0,52,8,"dispatch"],[89,6,52,8,"dispatch"],[89,14,52,16],[89,15,52,17],[89,48,52,16],[89,49,52,8],[90,0,54,8],[90,13,54,15,"auth"],[90,28,54,20,"signOut"],[90,35,54,15],[90,37,54,8],[91,0,55,5],[91,5,50,4],[92,0,56,1],[94,0,58,7],[94,11,58,16,"loginUser"],[94,20,58,7],[94,21,58,26,"email"],[94,26,58,7],[94,28,58,33,"password"],[94,36,58,7],[94,38,58,43],[95,0,59,4],[95,11,59,11],[95,21,59,11,"dispatch"],[95,29,59,19],[95,31,59,23],[96,0,60,8],[96,13,60,15,"auth"],[96,28,60,20,"signInWithEmailAndPassword"],[96,54,60,15],[96,55,60,47,"email"],[96,60,60,15],[96,62,60,54,"password"],[96,70,60,15],[96,72,61,9,"then"],[96,76,60,15],[96,77,61,14],[96,95,61,20,"user"],[96,99,61,14],[97,0,61,14],[98,0,61,14],[99,0,61,14],[100,0,61,14],[101,0,61,14],[102,0,62,18,"uid"],[102,16,62,18,"uid"],[102,19,61,14],[102,22,62,24,"user"],[102,26,62,28],[102,27,62,29,"user"],[102,31,62,24],[102,32,62,34,"uid"],[102,35,61,14],[103,0,64,12,"console"],[103,16,64,12,"console"],[103,23,64,19],[103,24,64,20,"log"],[103,27,64,12],[103,28,64,24,"uid"],[103,31,64,12],[104,0,61,14],[105,0,61,14],[105,50,66,31,"firestore"],[105,70,66,41,"collection"],[105,80,66,31],[105,81,66,52],[105,88,66,31],[105,90,66,61,"get"],[105,93,66,31],[105,95,61,14],[107,0,61,14],[108,0,66,18,"test"],[108,16,66,18,"test"],[108,20,61,14],[109,0,68,12,"console"],[109,16,68,12,"console"],[109,23,68,19],[109,24,68,20,"log"],[109,27,68,12],[109,28,68,24,"test"],[109,32,68,28],[109,33,68,29,"docs"],[109,37,68,24],[109,38,68,34],[109,39,68,24],[109,41,68,37,"data"],[109,45,68,24],[109,47,68,12],[110,0,61,14],[111,0,71,16,"console"],[111,16,71,16,"console"],[111,23,71,23],[111,24,71,24,"log"],[111,27,71,16],[111,28,71,28,"uid"],[111,31,71,16],[111,33,71,33],[111,52,71,16],[112,0,61,14],[113,0,61,14],[113,50,72,35,"firestore"],[113,70,72,45,"collection"],[113,80,72,35],[113,81,72,56],[113,88,72,35],[113,90,72,65,"doc"],[113,93,72,35],[113,94,72,69,"uid"],[113,97,72,35],[113,99,72,74,"get"],[113,102,72,35],[113,104,61,14],[115,0,61,14],[116,0,72,22,"data"],[116,16,72,22,"data"],[116,20,61,14],[117,0,73,16,"console"],[117,16,73,16,"console"],[117,23,73,23],[117,24,73,24,"log"],[117,27,73,16],[117,28,73,28],[117,41,73,16],[118,0,74,22,"parsed"],[118,16,74,22,"parsed"],[118,22,61,14],[118,25,74,31,"data"],[118,29,74,35],[118,30,74,36,"data"],[118,34,74,31],[118,36,61,14],[119,0,75,16,"console"],[119,16,75,16,"console"],[119,23,75,23],[119,24,75,24,"log"],[119,27,75,16],[119,28,75,28],[119,49,75,16],[119,51,75,51,"parsed"],[119,57,75,16],[120,0,76,16,"dispatch"],[120,16,76,16,"dispatch"],[120,24,76,24],[120,25,76,25,"saveUser"],[120,33,76,33],[120,34,76,34,"parsed"],[120,40,76,33],[120,41,76,24],[120,42,76,16],[121,0,61,14],[121,50,77,23,"parsed"],[121,56,61,14],[123,0,61,14],[124,0,61,14],[125,0,61,14],[126,0,79,16,"console"],[126,16,79,16,"console"],[126,23,79,23],[126,24,79,24,"log"],[126,27,79,16],[127,0,61,14],[127,50,80,23],[127,54,80,27,"Error"],[127,59,80,23],[127,60,80,33],[127,77,80,23],[127,78,61,14],[129,0,61,14],[130,0,61,14],[131,0,61,14],[132,0,61,14],[133,0,61,14],[134,0,61,14],[135,0,61,14],[135,7,60,15],[135,9,83,9,"catch"],[135,14,60,15],[135,15,83,15],[135,25,83,15,"err"],[135,28,83,18],[135,30,83,22],[136,0,84,12],[136,12,84,16,"message"],[136,19,84,23],[136,22,84,26],[136,24,84,12],[138,0,85,12],[138,12,85,15,"err"],[138,15,85,18],[138,16,85,19,"code"],[138,20,85,15],[138,25,85,28],[138,46,85,12],[138,48,85,51],[139,0,86,16,"message"],[139,10,86,16,"message"],[139,17,86,23],[139,20,86,26],[139,41,86,16],[140,0,87,13],[140,9,85,12],[140,15,87,19],[140,19,87,22,"err"],[140,22,87,25],[140,23,87,26,"code"],[140,27,87,22],[140,32,87,35,"auth"],[140,49,87,40,"user"],[140,53,87,35],[140,56,87,45,"not"],[140,59,87,35],[140,62,87,49,"found"],[140,67,87,19],[140,69,87,56],[141,0,88,16,"message"],[141,10,88,16,"message"],[141,17,88,23],[141,20,88,26],[141,46,88,16],[142,0,89,13],[142,9,87,19],[142,15,90,17,"message"],[142,22,90,24],[142,25,90,27],[142,42,90,17],[144,0,91,12],[144,15,91,19],[144,19,91,23,"Error"],[144,24,91,19],[144,25,91,29,"message"],[144,32,91,19],[144,33,91,12],[145,0,92,9],[145,7,60,15],[145,8,60,8],[146,0,93,5],[146,5,59,4],[147,0,94,1],[149,0,96,7],[149,11,96,16,"saveUser"],[149,19,96,7],[149,20,96,25,"data"],[149,24,96,7],[149,26,96,31],[150,0,97,4],[150,11,97,11],[151,0,98,8,"type"],[151,6,98,8,"type"],[151,10,98,12],[151,12,98,14,"SAVE_USER"],[151,21,97,11],[152,0,99,8,"paylord"],[152,6,99,8,"paylord"],[152,13,99,15],[152,15,99,17,"data"],[153,0,97,11],[153,5,97,4],[154,0,101,1],[156,0,103,7],[156,11,103,16,"logoutUser"],[156,21,103,7],[156,24,103,29],[157,0,104,4],[157,11,104,11],[158,0,105,8,"type"],[158,6,105,8,"type"],[158,10,105,12],[158,12,105,14,"LOGOUT"],[159,0,104,11],[159,5,104,4],[160,0,107,1],[162,0,109,7],[162,11,109,16,"setLastSync"],[162,22,109,7],[162,23,109,28,"date"],[162,27,109,7],[162,29,109,34],[163,0,110,4],[163,11,110,11],[164,0,111,8,"type"],[164,6,111,8,"type"],[164,10,111,12],[164,12,111,14,"SET_LAST_SYNC"],[164,25,110,11],[165,0,112,8,"date"],[165,6,112,8,"date"],[165,10,112,12],[165,12,112,8,"date"],[166,0,110,11],[166,5,110,4],[167,0,114,1],[169,0,116,7],[169,11,116,16,"setLastEnter"],[169,23,116,7],[169,24,116,29,"date"],[169,28,116,7],[169,30,116,35],[170,0,117,4],[170,11,117,11],[171,0,118,8,"type"],[171,6,118,8,"type"],[171,10,118,12],[171,12,118,14,"SET_LAST_ENTER"],[171,26,117,11],[172,0,119,8,"date"],[172,6,119,8,"date"],[172,10,119,12],[172,12,119,8,"date"],[173,0,117,11],[173,5,117,4],[174,0,121,1]]},"type":"js/module"}]}